<Window x:Class="BioSAK.StatisticsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Statistical Analysis" 
        Height="700" Width="850"
        WindowStartupLocation="CenterOwner"
        Background="#F5F5F5">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Grid.Row="0" Text="ðŸ“Š Statistical Analysis" FontSize="22" FontWeight="Bold" 
                   Foreground="#333" Margin="0,0,0,15"/>

        <!-- Main Content - Switches between Setup and Results -->
        <Grid Grid.Row="1">
            <!-- Step 1: Method Selection Panel -->
            <Border x:Name="MethodSelectionPanel" Background="White" CornerRadius="8" Padding="20">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" BlurRadius="10" Opacity="0.1"/>
                </Border.Effect>
                <StackPanel>
                    <TextBlock Text="Step 1: Select Statistical Method" FontSize="16" FontWeight="SemiBold" 
                               Foreground="#333" Margin="0,0,0,20"/>

                    <RadioButton x:Name="MethodRegression" GroupName="Method" Margin="0,5" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ˆ Linear Regression" FontWeight="SemiBold"/>
                            <TextBlock Text="RÂ², Pearson correlation, slope significance for each series" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton x:Name="MethodTTest" GroupName="Method" Margin="0,10" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ”¬ T-Test (Two Groups)" FontWeight="SemiBold"/>
                            <TextBlock Text="Compare two series at a specific X value using replicate data" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton x:Name="MethodOneWayAnovaSameX" GroupName="Method" Margin="0,10" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ One-Way ANOVA (Same X)" FontWeight="SemiBold"/>
                            <TextBlock Text="Compare multiple series at a specific X value" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton x:Name="MethodOneWayAnovaSameRow" GroupName="Method" Margin="0,10" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ One-Way ANOVA (Same Series)" FontWeight="SemiBold"/>
                            <TextBlock Text="Compare different X values within one series" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton x:Name="MethodTwoWayAnova" GroupName="Method" Margin="0,10" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ“Š Two-Way ANOVA" FontWeight="SemiBold"/>
                            <TextBlock Text="Analyze effects of Series and X value (requires multiple rows)" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <RadioButton x:Name="MethodDescriptive" GroupName="Method" Margin="0,10" FontSize="14">
                        <StackPanel>
                            <TextBlock Text="ðŸ“‹ Descriptive Statistics" FontWeight="SemiBold"/>
                            <TextBlock Text="Mean, SD, SEM, Min, Max, Median for each series" 
                                       Foreground="#666" FontSize="12" Margin="20,2,0,0"/>
                        </StackPanel>
                    </RadioButton>

                    <Button Content="Next â†’" HorizontalAlignment="Right" Margin="0,25,0,0" Padding="25,10"
                            Background="#2196F3" Foreground="White" BorderThickness="0" FontSize="14"
                            Cursor="Hand" Click="NextToSetup_Click"/>
                </StackPanel>
            </Border>

            <!-- Step 2: Setup Panel (shown after method selection) -->
            <Border x:Name="SetupPanel" Background="White" CornerRadius="8" Padding="20" Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" BlurRadius="10" Opacity="0.1"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0">
                        <TextBlock x:Name="SetupTitle" Text="Step 2: Configure Analysis" FontSize="16" FontWeight="SemiBold" 
                                   Foreground="#333" Margin="0,0,0,15"/>
                    </StackPanel>

                    <!-- Dynamic setup content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="SetupContent" Margin="0,0,0,10"/>
                    </ScrollViewer>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="â† Back" Margin="0,0,10,0" Padding="20,10"
                                Background="#9E9E9E" Foreground="White" BorderThickness="0" FontSize="14"
                                Cursor="Hand" Click="BackToMethodSelection_Click"/>
                        <Button Content="Run Analysis" Padding="25,10"
                                Background="#4CAF50" Foreground="White" BorderThickness="0" FontSize="14"
                                Cursor="Hand" Click="RunAnalysis_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Step 3: Results Panel -->
            <Border x:Name="ResultsPanel" Background="White" CornerRadius="8" Padding="20" Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" BlurRadius="10" Opacity="0.1"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock x:Name="ResultsTitle" Grid.Row="0" Text="Results" FontSize="16" FontWeight="SemiBold" 
                               Foreground="#333" Margin="0,0,0,15"/>

                    <DataGrid Grid.Row="1" x:Name="ResultsGrid" 
                              AutoGenerateColumns="True" IsReadOnly="True"
                              CanUserAddRows="False" CanUserDeleteRows="False"
                              GridLinesVisibility="All" Background="White"
                              HorizontalGridLinesBrush="#E0E0E0" VerticalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#FAFAFA"/>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                        <Button Content="â† New Analysis" Margin="0,0,10,0" Padding="20,10"
                                Background="#FF9800" Foreground="White" BorderThickness="0" FontSize="14"
                                Cursor="Hand" Click="BackToMethodSelection_Click"/>
                        <Button Content="ðŸ“‹ Copy Results" Padding="20,10"
                                Background="#4CAF50" Foreground="White" BorderThickness="0" FontSize="14"
                                Cursor="Hand" Click="CopyResults_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Close" Padding="20,10"
                    Background="#757575" Foreground="White" BorderThickness="0"
                    Cursor="Hand" Click="Close_Click"/>
        </StackPanel>
    </Grid>
</Window>
